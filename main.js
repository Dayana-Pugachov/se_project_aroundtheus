!function(){"use strict";class e{constructor(e,t,s,r,i){this._name=e.name,this._link=e.link,this._id=e._id,this._cardSelector=t,this._handleImageClick=s,this._handleDeleteClick=r,this._handleLikeClick=i,this._isLiked=e.isLiked}_getTemplate(){return document.querySelector(this._cardSelector).content.firstElementChild.cloneNode(!0)}_setEventListeners(){this._element.querySelector(".card__image").addEventListener("click",(()=>{this._handleImageClick(this._link,this._name)})),this._likeButton=this._element.querySelector(".card__like-button"),this._likeButton.addEventListener("click",(()=>{this._handleLikeClick(this)})),this._element.querySelector(".card__trash-button").addEventListener("click",(()=>{this._handleDeleteClick(this)}))}removeCard(){this._element.remove()}generateCard(){this._element=this._getTemplate(),this._setEventListeners(),this._renderLikes();const e=this._element.querySelector(".card__title"),t=this._element.querySelector(".card__image");return t.setAttribute("src",this._link),t.setAttribute("alt",this._name),e.textContent=this._name,this._element}getId(){return this._id}getLikeStatus(){return this._isLiked}setLikeStatus(e){this._isLiked=e,this._renderLikes()}_renderLikes(){this._isLiked?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active")}}class t{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._element=t}_showError(e,t){const s=this._element.querySelector(`.${e.id}-error`);e.classList.add(this._inputErrorClass),s.textContent=t,s.classList.add(this._errorClass)}_hideError(e){const t=this._element.querySelector(`.${e.id}-error`);e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""}_hasInvalidInput(e){return e.some((e=>!e.validity.valid))}toggleButtonState(){this._hasInvalidInput(this._inputList)?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.setAttribute("disabled","")):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.removeAttribute("disabled",""))}_checkInputValidity(e){e.validity.valid?this._hideError(e):this._showError(e,e.validationMessage)}_setEventListeners(){this._inputList=Array.from(this._element.querySelectorAll(this._inputSelector)),this._buttonElement=this._element.querySelector(this._submitButtonSelector),this.toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._element.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this.toggleButtonState(),this._inputList.forEach((e=>{this._hideError(e)}))}}class s{constructor(e,t){let{items:s,renderer:r}=e;this._renderedItems=s,this._renderer=r,this._container=document.querySelector(t)}renderItems(){this._renderedItems.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}class r{constructor(e){this._popupElement=document.querySelector(e)}openModal(){document.addEventListener("keydown",this._handleEsc),this._popupElement.classList.add("modal_opened")}closeModal(){document.removeEventListener("keydown",this._handleEsc),this._popupElement.classList.remove("modal_opened")}_handleEsc=e=>{"Escape"===e.key&&this.closeModal()};setEventListeners(){this._popupElement.addEventListener("click",(e=>{(e.target===this._popupElement||e.target.classList.contains("modal__close"))&&this.closeModal()}))}}class i extends r{constructor(e){let{popupSelector:t,handleFormSubmit:s}=e;super(t),this._handleFormSubmit=s,this._popupForm=this._popupElement.querySelector(".modal__form"),this._saveButton=this._popupElement.querySelector(".modal__save"),this._saveButtonText=this._saveButton.textContent}_getInputValues(){return this._inputList=this._popupElement.querySelectorAll(".modal__input"),this._formValues={},this._inputList.forEach((e=>{this._formValues[e.name]=e.value})),this._formValues}setEventListeners(){this._popupElement.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())})),super.setEventListeners()}closeModal(){this._popupForm.reset(),super.closeModal()}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._saveButton.textContent=e?t:this._saveButtonText}}const n=document.querySelector(".profile__edit-button"),o=document.querySelector(".modal__form"),a=document.querySelector(".profile__add-button"),l=document.querySelector(".profile__avatar-wrapper"),d=o.querySelector("#name-input-js"),c=o.querySelector("#description-input-js"),h={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__save",inactiveButtonClass:"modal__save_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__input-error_active"},u=document.querySelector("#editProfile-modal-form"),_=document.querySelector("#addCard-modal-form"),m=document.querySelector("#avatar-modal-form"),p=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}loadUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._checkResponse)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._checkResponse)}editUserInfo(e,t){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then(this._checkResponse)}addNewCard(e,t){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}likeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._checkResponse)}unlikeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}updateAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._checkResponse)}loadPageContent(){return Promise.all([this.loadUserInfo(),this.getInitialCards()])}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"5bd639c7-c1c3-496d-947f-3773995c6d1b","Content-Type":"application/json"}});let v;p.loadPageContent().then((e=>{let[t,r]=e;S.setUserInfo(t.name,t.about),S.setAvatar(t.avatar),v=new s({items:r.reverse(),renderer:e=>{const t=g(e);v.addItem(t)}},".gallery__list"),v.renderItems()})).catch(console.error);const S=new class{constructor(e){let{profileNameSelector:t,profileDescriptionSelector:s,profileAvatarSelector:r}=e;this._profileName=document.querySelector(t),this._profileDescription=document.querySelector(s),this._profileAvatar=document.querySelector(r)}getUserInfo(){return{name:this._profileName.textContent,description:this._profileDescription.textContent}}setUserInfo(e,t){this._profileName.textContent=e,this._profileDescription.textContent=t}setAvatar(e){this._profileAvatar.src=e}}({profileNameSelector:".profile__title",profileDescriptionSelector:".profile__description",profileAvatarSelector:".profile__avatar"});n.addEventListener("click",(()=>{const e=S.getUserInfo();d.value=e.name,c.value=e.description,q.resetValidation(),f.openModal()}));const f=new i({popupSelector:"#edit-modal",handleFormSubmit:function(e){f.renderLoading(!0),p.editUserInfo(e.name,e.description).then((e=>{S.setUserInfo(e.name,e.about),f.closeModal(),q.toggleButtonState()})).catch(console.error).finally((()=>{f.renderLoading(!1)}))}});f.setEventListeners();const L=new i({popupSelector:"#avatar-modal",handleFormSubmit:function(e){L.renderLoading(!0),p.updateAvatar(e.link).then((e=>{S.setAvatar(e.avatar),L.closeModal(),w.toggleButtonState()})).catch(console.error).finally((()=>{L.renderLoading(!1)}))}});L.setEventListeners(),l.addEventListener("click",(()=>{w.resetValidation(),L.openModal()}));const E=new class extends r{constructor(e){let{popupSelector:t}=e;super(t),this._previewImage=document.querySelector(".modal__image"),this._previewDescription=document.querySelector(".modal__description")}openModal(e,t){this._previewImage.setAttribute("src",e),this._previewImage.setAttribute("alt",t),this._previewDescription.textContent=t,super.openModal()}}({popupSelector:"#previewModal"});function k(e,t){E.openModal(e,t)}E.setEventListeners();const b=new i({popupSelector:"#add-modal",handleFormSubmit:function(e){b.renderLoading(!0),p.addNewCard(e.name,e.link).then((e=>{const t=g(e);v.addItem(t),b.closeModal(),B.toggleButtonState()})).catch(console.error).finally((()=>{b.renderLoading(!1)}))}});function C(e){I.openModal(e)}function g(t){return new e(t,"#card-template",k,C,y).generateCard()}function y(e){const t=e.getId();e.getLikeStatus()?p.unlikeCard(t).then((()=>{e.setLikeStatus(!1)})).catch(console.error):p.likeCard(t).then((()=>{e.setLikeStatus(!0)})).catch(console.error)}a.addEventListener("click",(()=>{B.resetValidation(),b.openModal()})),b.setEventListeners();const I=new class extends r{constructor(e){let{popupSelector:t,handleConfirmSubmit:s}=e;super(t),this._handleConfirmSubmit=s,this._confirmButton=document.querySelector(".modal__save_confirm")}setEventListeners(){this._confirmButton.addEventListener("click",(()=>{this._handleConfirmSubmit(this._cardData)})),super.setEventListeners()}openModal(e){this._cardData=e,super.openModal()}}({popupSelector:"#confirmationModal",handleConfirmSubmit:function(e){const t=e.getId();p.deleteCard(t).then((()=>{e.removeCard(),I.closeModal()})).catch(console.error)}});I.setEventListeners();const q=new t(h,u),B=new t(h,_),w=new t(h,m);q.enableValidation(),B.enableValidation(),w.enableValidation()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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bEJtSCxFQUFvQm5ILGtCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQ29uZmlybVBvcHVwLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgZGF0YSxcclxuICAgIGNhcmRTZWxlY3RvcixcclxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXHJcbiAgICBoYW5kbGVEZWxldGVDbGljayxcclxuICAgIGhhbmRsZUxpa2VDbGlja1xyXG4gICkge1xyXG4gICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcclxuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XHJcbiAgICB0aGlzLl9pZCA9IGRhdGEuX2lkO1xyXG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xyXG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayA9IGhhbmRsZURlbGV0ZUNsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrID0gaGFuZGxlTGlrZUNsaWNrO1xyXG4gICAgdGhpcy5faXNMaWtlZCA9IGRhdGEuaXNMaWtlZDtcclxuICB9XHJcblxyXG4gIF9nZXRUZW1wbGF0ZSgpIHtcclxuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxyXG4gICAgICAuY29udGVudC5maXJzdEVsZW1lbnRDaGlsZC5jbG9uZU5vZGUodHJ1ZSk7XHJcblxyXG4gICAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgY29uc3QgY2FyZEltYWdlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG4gICAgY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sodGhpcy5fbGluaywgdGhpcy5fbmFtZSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sodGhpcyk7XHJcbiAgICAgIC8vdGhpcy5faGFuZGxlQ2FyZExpa2UoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vbXkgdHJhc2ggYnV0dG9uXHJcbiAgICBjb25zdCB0cmFzaEJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190cmFzaC1idXR0b25cIik7XHJcbiAgICB0cmFzaEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayh0aGlzKTtcclxuICAgICAgLy90aGlzLl9oYW5kbGVEZWxldGVDYXJkKCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHJlbW92ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xyXG4gIH1cclxuXHJcbiAgLypoYW5kbGVDYXJkTGlrZSgpIHtcclxuICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICB9Ki9cclxuXHJcbiAgZ2VuZXJhdGVDYXJkKCkge1xyXG4gICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcclxuXHJcbiAgICBjb25zdCBjYXJkVGl0bGUgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XHJcbiAgICBjb25zdCBjYXJkSW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcblxyXG4gICAgY2FyZEltYWdlLnNldEF0dHJpYnV0ZShcInNyY1wiLCB0aGlzLl9saW5rKTtcclxuICAgIGNhcmRJbWFnZS5zZXRBdHRyaWJ1dGUoXCJhbHRcIiwgdGhpcy5fbmFtZSk7XHJcbiAgICBjYXJkVGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG5cclxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgZ2V0SWQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faWQ7XHJcbiAgfVxyXG5cclxuICBnZXRMaWtlU3RhdHVzKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2lzTGlrZWQ7XHJcbiAgfVxyXG5cclxuICBzZXRMaWtlU3RhdHVzKHN0YXR1cykge1xyXG4gICAgdGhpcy5faXNMaWtlZCA9IHN0YXR1cztcclxuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7IC8vbm90IHN1cmUgYWJvdXQgdXNpbmcgdGhpcyBvbmUgaGVyZVxyXG4gIH1cclxuXHJcbiAgX3JlbmRlckxpa2VzKCkge1xyXG4gICAgaWYgKHRoaXMuX2lzTGlrZWQpIHtcclxuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3RvcihvcHRpb25zLCBmb3JtRWxlbWVudCkge1xyXG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IG9wdGlvbnMuaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gb3B0aW9ucy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBvcHRpb25zLmluYWN0aXZlQnV0dG9uQ2xhc3M7XHJcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBvcHRpb25zLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBvcHRpb25zLmVycm9yQ2xhc3M7XHJcblxyXG4gICAgdGhpcy5fZWxlbWVudCA9IGZvcm1FbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgX3Nob3dFcnJvcihpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSkge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfaGlkZUVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gIH1cclxuXHJcbiAgX2hhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpIHtcclxuICAgIHJldHVybiBpbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIHJldHVybiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICB0b2dnbGVCdXR0b25TdGF0ZSgpIHtcclxuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQodGhpcy5faW5wdXRMaXN0KSkge1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgXCJcIik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgXCJcIik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xyXG4gICAgaWYgKGlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9oaWRlRXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX3Nob3dFcnJvcihpbnB1dEVsZW1lbnQsIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKFxyXG4gICAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcilcclxuICAgICk7XHJcbiAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvclxyXG4gICAgKTtcclxuICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuXHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcblxyXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuXHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIHRoaXMuX2hpZGVFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9yZW5kZXJlZEl0ZW1zID0gaXRlbXM7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICByZW5kZXJJdGVtcygpIHtcclxuICAgIHRoaXMuX3JlbmRlcmVkSXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBvcGVuTW9kYWwoKSB7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2MpO1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgfVxyXG5cclxuICBjbG9zZU1vZGFsKCkge1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjKTtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUVzYyA9IChldnQpID0+IHtcclxuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIHRoaXMuY2xvc2VNb2RhbCgpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGlmIChcclxuICAgICAgICBldnQudGFyZ2V0ID09PSB0aGlzLl9wb3B1cEVsZW1lbnQgfHxcclxuICAgICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX19jbG9zZVwiKVxyXG4gICAgICApIHtcclxuICAgICAgICB0aGlzLmNsb3NlTW9kYWwoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQgfSkge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG4gICAgdGhpcy5fc2F2ZUJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zYXZlXCIpO1xyXG4gICAgdGhpcy5fc2F2ZUJ1dHRvblRleHQgPSB0aGlzLl9zYXZlQnV0dG9uLnRleHRDb250ZW50O1xyXG4gIH1cclxuXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpO1xyXG4gICAgdGhpcy5fZm9ybVZhbHVlcyA9IHt9O1xyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIHRoaXMuX2Zvcm1WYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHRoaXMuX2Zvcm1WYWx1ZXM7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7IC8vdGhpcyBpcyB3aGVyZSBpbnB1dFZhbHVlcyBwYXJhbSBjb21lcyBmcm9tLiBUaGF0J3Mgd2h5IHdlIGNvbnNlcXVlbnRseSBwYXNzIGl0IGluIGluZGV4LmpzIGluc2lkZSBoYW5kbGVGb3JtU3VibWl0KCpoZXJlKik7XHJcbiAgICB9KTtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG5cclxuICBjbG9zZU1vZGFsKCkge1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XHJcbiAgICBzdXBlci5jbG9zZU1vZGFsKCk7XHJcbiAgfVxyXG5cclxuICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZywgbG9hZGluZ1RleHQgPSBcIlNhdmluZy4uLlwiKSB7XHJcbiAgICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICAgIHRoaXMuX3NhdmVCdXR0b24udGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX3NhdmVCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9zYXZlQnV0dG9uVGV4dDtcclxuICAgIH1cclxuICB9XHJcbiAgLypzZXRCdXR0b25UZXh0KHRleHQpIHtcclxuICAgIHRoaXMuX3NhdmVCdXR0b24udGV4dENvbnRlbnQgPSB0ZXh0O1xyXG4gIH0qL1xyXG59XHJcbiIsIi8vRUxFTUVOVFMgLS0tLS1cclxuY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xyXG5jb25zdCBwcm9maWxlRm9ybUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG5jb25zdCBwcm9maWxlQWRkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xyXG5jb25zdCBwcm9maWxlQXZhdGFyV3JhcHBlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyLXdyYXBwZXJcIik7XHJcblxyXG4vL0lOUFVUUyAtLS0tLVxyXG5jb25zdCBlZGl0UHJvZmlsZVRpdGxlSW5wdXQgPVxyXG4gIHByb2ZpbGVGb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI25hbWUtaW5wdXQtanNcIik7XHJcbmNvbnN0IGVkaXRQcm9maWxlRGVzY3JpcHRpb25JbnB1dCA9IHByb2ZpbGVGb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiI2Rlc2NyaXB0aW9uLWlucHV0LWpzXCJcclxuKTtcclxuXHJcbi8vRk9STSBWQUxJREFUT1IgT1BUSU9OUyAtLS0tLVxyXG5jb25zdCBvcHRpb25zID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX3NhdmVcIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19zYXZlX2Rpc2FibGVkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXQtZXJyb3JfYWN0aXZlXCIsXHJcbn07XHJcblxyXG4vL0ZPUk1TIC0tLS0tXHJcbmNvbnN0IGVkaXRQcm9maWxlRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdFByb2ZpbGUtbW9kYWwtZm9ybVwiKTtcclxuY29uc3QgYWRkQ2FyZEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZENhcmQtbW9kYWwtZm9ybVwiKTtcclxuY29uc3QgYXZhdGFyRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLW1vZGFsLWZvcm1cIik7XHJcblxyXG5leHBvcnQge1xyXG4gIHByb2ZpbGVFZGl0QnV0dG9uLFxyXG4gIHByb2ZpbGVBZGRCdXR0b24sXHJcbiAgcHJvZmlsZUF2YXRhcldyYXBwZXIsXHJcbiAgZWRpdFByb2ZpbGVUaXRsZUlucHV0LFxyXG4gIGVkaXRQcm9maWxlRGVzY3JpcHRpb25JbnB1dCxcclxuICBvcHRpb25zLFxyXG4gIGVkaXRQcm9maWxlRm9ybSxcclxuICBhZGRDYXJkRm9ybSxcclxuICBhdmF0YXJGb3JtLFxyXG59O1xyXG4iLCIvLyBDTEFTU0VTIElNUE9SVFMgKyBTVFlMRVNIRUVUIC0tLS0tXHJcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xyXG5cclxuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuXHJcbi8vIENPTlNUQU5UUyBJTVBPUlRTIC0tLS0tXHJcbmltcG9ydCB7XHJcbiAgcHJvZmlsZUVkaXRCdXR0b24sXHJcbiAgcHJvZmlsZUFkZEJ1dHRvbixcclxuICBwcm9maWxlQXZhdGFyV3JhcHBlcixcclxuICBlZGl0UHJvZmlsZVRpdGxlSW5wdXQsXHJcbiAgZWRpdFByb2ZpbGVEZXNjcmlwdGlvbklucHV0LFxyXG4gIG9wdGlvbnMsXHJcbiAgZWRpdFByb2ZpbGVGb3JtLFxyXG4gIGFkZENhcmRGb3JtLFxyXG4gIGF2YXRhckZvcm0sXHJcbn0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5pbXBvcnQgQ29uZmlybVBvcHVwIGZyb20gXCIuLi9jb21wb25lbnRzL0NvbmZpcm1Qb3B1cC5qc1wiO1xyXG5cclxuLy9QQUdFIExPQUQgLS0tLS1cclxuXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcIjViZDYzOWM3LWMxYzMtNDk2ZC05NDdmLTM3NzM5OTVjNmQxYlwiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfSxcclxufSk7XHJcblxyXG5sZXQgZ2FsbGVyeUxpc3RTZWN0aW9uO1xyXG5hcGlcclxuICAubG9hZFBhZ2VDb250ZW50KClcclxuICAudGhlbigoW3VzZXJEYXRhLCBjYXJkQXJyXSkgPT4ge1xyXG4gICAgdXNlckluZm8uc2V0VXNlckluZm8odXNlckRhdGEubmFtZSwgdXNlckRhdGEuYWJvdXQpO1xyXG4gICAgdXNlckluZm8uc2V0QXZhdGFyKHVzZXJEYXRhLmF2YXRhcik7XHJcblxyXG4gICAgZ2FsbGVyeUxpc3RTZWN0aW9uID0gbmV3IFNlY3Rpb24oXHJcbiAgICAgIHtcclxuICAgICAgICBpdGVtczogY2FyZEFyci5yZXZlcnNlKCksXHJcbiAgICAgICAgcmVuZGVyZXI6IChkYXRhKSA9PiB7XHJcbiAgICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoZGF0YSk7XHJcbiAgICAgICAgICBnYWxsZXJ5TGlzdFNlY3Rpb24uYWRkSXRlbShjYXJkRWxlbWVudCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgfSxcclxuICAgICAgXCIuZ2FsbGVyeV9fbGlzdFwiXHJcbiAgICApO1xyXG4gICAgZ2FsbGVyeUxpc3RTZWN0aW9uLnJlbmRlckl0ZW1zKCk7XHJcbiAgfSlcclxuICAuY2F0Y2goY29uc29sZS5lcnJvcik7XHJcblxyXG4vLyBVU0VSIElORk8gLS0tLS1cclxuXHJcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcclxuICBwcm9maWxlTmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX190aXRsZVwiLFxyXG4gIHByb2ZpbGVEZXNjcmlwdGlvblNlbGVjdG9yOiBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiLFxyXG4gIHByb2ZpbGVBdmF0YXJTZWxlY3RvcjogXCIucHJvZmlsZV9fYXZhdGFyXCIsXHJcbn0pO1xyXG5cclxucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjb25zdCBpbmZvID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcclxuICBlZGl0UHJvZmlsZVRpdGxlSW5wdXQudmFsdWUgPSBpbmZvLm5hbWU7XHJcbiAgZWRpdFByb2ZpbGVEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gaW5mby5kZXNjcmlwdGlvbjtcclxuICBlZGl0Rm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcclxuICBwcm9maWxlRm9ybVBvcHVwLm9wZW5Nb2RhbCgpO1xyXG59KTtcclxuXHJcbi8vIFBST0ZJTEUgRk9STSBQT1BVUCAtLS0tLVxyXG5cclxuY29uc3QgcHJvZmlsZUZvcm1Qb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcclxuICBwb3B1cFNlbGVjdG9yOiBcIiNlZGl0LW1vZGFsXCIsXHJcbiAgaGFuZGxlRm9ybVN1Ym1pdDogaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQsXHJcbn0pO1xyXG5cclxucHJvZmlsZUZvcm1Qb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQoaW5wdXRWYWx1ZXMpIHtcclxuICBwcm9maWxlRm9ybVBvcHVwLnJlbmRlckxvYWRpbmcodHJ1ZSk7XHJcbiAgYXBpXHJcbiAgICAuZWRpdFVzZXJJbmZvKGlucHV0VmFsdWVzLm5hbWUsIGlucHV0VmFsdWVzLmRlc2NyaXB0aW9uKVxyXG4gICAgLnRoZW4oKHVzZXJEYXRhKSA9PiB7XHJcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHVzZXJEYXRhLm5hbWUsIHVzZXJEYXRhLmFib3V0KTtcclxuICAgICAgcHJvZmlsZUZvcm1Qb3B1cC5jbG9zZU1vZGFsKCk7XHJcbiAgICAgIGVkaXRGb3JtVmFsaWRhdG9yLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHByb2ZpbGVGb3JtUG9wdXAucmVuZGVyTG9hZGluZyhmYWxzZSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuLy9BVkFUQVIgRk9STSBQT1BVUCAtLS0tLVxyXG5cclxuY29uc3QgYXZhdGFyRm9ybVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xyXG4gIHBvcHVwU2VsZWN0b3I6IFwiI2F2YXRhci1tb2RhbFwiLFxyXG4gIGhhbmRsZUZvcm1TdWJtaXQ6IGhhbmRsZUF2YXRhckZvcm1TdWJtaXQsXHJcbn0pO1xyXG5cclxuYXZhdGFyRm9ybVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5wcm9maWxlQXZhdGFyV3JhcHBlci5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGF2YXRhckZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgYXZhdGFyRm9ybVBvcHVwLm9wZW5Nb2RhbCgpO1xyXG59KTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUF2YXRhckZvcm1TdWJtaXQoaW5wdXRWYWx1ZSkge1xyXG4gIGF2YXRhckZvcm1Qb3B1cC5yZW5kZXJMb2FkaW5nKHRydWUpO1xyXG4gIGFwaVxyXG4gICAgLnVwZGF0ZUF2YXRhcihpbnB1dFZhbHVlLmxpbmspXHJcbiAgICAudGhlbigodXNlckRhdGEpID0+IHtcclxuICAgICAgdXNlckluZm8uc2V0QXZhdGFyKHVzZXJEYXRhLmF2YXRhcik7XHJcbiAgICAgIGF2YXRhckZvcm1Qb3B1cC5jbG9zZU1vZGFsKCk7XHJcbiAgICAgIGF2YXRhckZvcm1WYWxpZGF0b3IudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goY29uc29sZS5lcnJvcilcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgYXZhdGFyRm9ybVBvcHVwLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8vIFBPUFVQIFdJVEggSU1BR0UgLS0tLS1cclxuXHJcbmNvbnN0IHBvcHVwV2l0aEltYWdlID0gbmV3IFBvcHVwV2l0aEltYWdlKHtcclxuICBwb3B1cFNlbGVjdG9yOiBcIiNwcmV2aWV3TW9kYWxcIixcclxufSk7XHJcblxyXG5wb3B1cFdpdGhJbWFnZS5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlSW1hZ2VDbGljayhsaW5rLCBuYW1lKSB7XHJcbiAgcG9wdXBXaXRoSW1hZ2Uub3Blbk1vZGFsKGxpbmssIG5hbWUpO1xyXG59XHJcblxyXG4vLyBBREQgTkVXIENBUkQgRk9STSAtLS0tLVxyXG5cclxuY29uc3QgbmV3Q2FyZEZvcm1Qb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcclxuICBwb3B1cFNlbGVjdG9yOiBcIiNhZGQtbW9kYWxcIixcclxuICBoYW5kbGVGb3JtU3VibWl0OiBoYW5kbGVBZGRDYXJkRm9ybVN1Ym1pdCxcclxufSk7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVDbGljayhjYXJkRGF0YSkge1xyXG4gIGNvbmZpcm1Qb3B1cC5vcGVuTW9kYWwoY2FyZERhdGEpO1xyXG59XHJcblxyXG5wcm9maWxlQWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgY2FyZEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgbmV3Q2FyZEZvcm1Qb3B1cC5vcGVuTW9kYWwoKTtcclxufSk7XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVDYXJkKGRhdGEpIHtcclxuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXHJcbiAgICBkYXRhLFxyXG4gICAgXCIjY2FyZC10ZW1wbGF0ZVwiLFxyXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcclxuICAgIGhhbmRsZURlbGV0ZUNsaWNrLFxyXG4gICAgaGFuZGxlTGlrZUNsaWNrXHJcbiAgKTtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IGNhcmQuZ2VuZXJhdGVDYXJkKCk7XHJcbiAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVMaWtlQ2xpY2soY2FyZCkge1xyXG4gIGNvbnN0IGNhcmRJZCA9IGNhcmQuZ2V0SWQoKTtcclxuICBpZiAoY2FyZC5nZXRMaWtlU3RhdHVzKCkpIHtcclxuICAgIGFwaVxyXG4gICAgICAudW5saWtlQ2FyZChjYXJkSWQpXHJcbiAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICBjYXJkLnNldExpa2VTdGF0dXMoZmFsc2UpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goY29uc29sZS5lcnJvcik7XHJcbiAgfSBlbHNlIHtcclxuICAgIGFwaVxyXG4gICAgICAubGlrZUNhcmQoY2FyZElkKVxyXG4gICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgY2FyZC5zZXRMaWtlU3RhdHVzKHRydWUpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goY29uc29sZS5lcnJvcik7XHJcbiAgfVxyXG59XHJcblxyXG5uZXdDYXJkRm9ybVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVBZGRDYXJkRm9ybVN1Ym1pdChpbnB1dFZhbHVlcykge1xyXG4gIG5ld0NhcmRGb3JtUG9wdXAucmVuZGVyTG9hZGluZyh0cnVlKTtcclxuICBhcGlcclxuICAgIC5hZGROZXdDYXJkKGlucHV0VmFsdWVzLm5hbWUsIGlucHV0VmFsdWVzLmxpbmspXHJcbiAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoZGF0YSk7XHJcbiAgICAgIGdhbGxlcnlMaXN0U2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTtcclxuICAgICAgbmV3Q2FyZEZvcm1Qb3B1cC5jbG9zZU1vZGFsKCk7XHJcbiAgICAgIGNhcmRGb3JtVmFsaWRhdG9yLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIG5ld0NhcmRGb3JtUG9wdXAucmVuZGVyTG9hZGluZyhmYWxzZSk7XHJcbiAgICB9KTtcclxufVxyXG5cclxuLy9DT05GSVJNQVRJT04gUE9QVVAgLS0tLS1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUNvbmZpcm1TdWJtaXQoY2FyZCkge1xyXG4gIGNvbnN0IGNhcmRJZCA9IGNhcmQuZ2V0SWQoKTtcclxuICBhcGlcclxuICAgIC5kZWxldGVDYXJkKGNhcmRJZClcclxuICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgY2FyZC5yZW1vdmVDYXJkKCk7XHJcbiAgICAgIGNvbmZpcm1Qb3B1cC5jbG9zZU1vZGFsKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xyXG59XHJcblxyXG5jb25zdCBjb25maXJtUG9wdXAgPSBuZXcgQ29uZmlybVBvcHVwKHtcclxuICBwb3B1cFNlbGVjdG9yOiBcIiNjb25maXJtYXRpb25Nb2RhbFwiLFxyXG4gIGhhbmRsZUNvbmZpcm1TdWJtaXQsXHJcbn0pO1xyXG5cclxuY29uZmlybVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vL0ZPUk0gSU5JVCAtLS0tLVxyXG5cclxuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihvcHRpb25zLCBlZGl0UHJvZmlsZUZvcm0pO1xyXG5jb25zdCBjYXJkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKG9wdGlvbnMsIGFkZENhcmRGb3JtKTtcclxuY29uc3QgYXZhdGFyRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKG9wdGlvbnMsIGF2YXRhckZvcm0pO1xyXG5cclxuZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5jYXJkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbmF2YXRhckZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XHJcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcclxuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrUmVzcG9uc2UocmVzKSB7XHJcbiAgICAvL2dldHMgY2FsbGVkIGluIGVhY2ggbWV0aG9kIGluIC50aGVuXHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gIH1cclxuXHJcbiAgbG9hZFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBlZGl0VXNlckluZm8obmFtZSwgYWJvdXQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBuYW1lLFxyXG4gICAgICAgIGFib3V0OiBhYm91dCxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgYWRkTmV3Q2FyZChuYW1lLCBsaW5rKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBuYW1lLFxyXG4gICAgICAgIGxpbms6IGxpbmssXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgbGlrZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgdW5saWtlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVBdmF0YXIobGluaykge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBhdmF0YXI6IGxpbmssXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGxvYWRQYWdlQ29udGVudCgpIHtcclxuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5sb2FkVXNlckluZm8oKSwgdGhpcy5nZXRJbml0aWFsQ2FyZHMoKV0pO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3Ioe1xyXG4gICAgcHJvZmlsZU5hbWVTZWxlY3RvcixcclxuICAgIHByb2ZpbGVEZXNjcmlwdGlvblNlbGVjdG9yLFxyXG4gICAgcHJvZmlsZUF2YXRhclNlbGVjdG9yLFxyXG4gIH0pIHtcclxuICAgIHRoaXMuX3Byb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwcm9maWxlTmFtZVNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3Byb2ZpbGVEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIHByb2ZpbGVEZXNjcmlwdGlvblNlbGVjdG9yXHJcbiAgICApO1xyXG4gICAgdGhpcy5fcHJvZmlsZUF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocHJvZmlsZUF2YXRhclNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbmFtZTogdGhpcy5fcHJvZmlsZU5hbWUudGV4dENvbnRlbnQsXHJcbiAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLl9wcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQsXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8obmFtZSwgZGVzY3JpcHRpb24pIHtcclxuICAgIHRoaXMuX3Byb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHRoaXMuX3Byb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IGRlc2NyaXB0aW9uO1xyXG4gIH1cclxuXHJcbiAgc2V0QXZhdGFyKGF2YXRhcikge1xyXG4gICAgdGhpcy5fcHJvZmlsZUF2YXRhci5zcmMgPSBhdmF0YXI7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fcHJldmlld0ltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9wcmV2aWV3RGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19kZXNjcmlwdGlvblwiKTtcclxuICB9XHJcblxyXG4gIG9wZW5Nb2RhbChsaW5rLCBuYW1lKSB7XHJcbiAgICB0aGlzLl9wcmV2aWV3SW1hZ2Uuc2V0QXR0cmlidXRlKFwic3JjXCIsIGxpbmspO1xyXG4gICAgdGhpcy5fcHJldmlld0ltYWdlLnNldEF0dHJpYnV0ZShcImFsdFwiLCBuYW1lKTtcclxuICAgIHRoaXMuX3ByZXZpZXdEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICBzdXBlci5vcGVuTW9kYWwoKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDb25maXJtUG9wdXAgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yLCBoYW5kbGVDb25maXJtU3VibWl0IH0pIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5faGFuZGxlQ29uZmlybVN1Ym1pdCA9IGhhbmRsZUNvbmZpcm1TdWJtaXQ7IC8vaGFuZGxlQ29uZmlybVN1Ym1pdCA9IHRoZSBmdW5jIHRoYXQgZXhlY3V0ZXMgYXBpIFwiREVMRVRFXCIgbG9naWMsIGl0J3MgbGlrZSBhIHJlbmRlcmVyXHJcbiAgICB0aGlzLl9jb25maXJtQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fc2F2ZV9jb25maXJtXCIpO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9jb25maXJtQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUNvbmZpcm1TdWJtaXQodGhpcy5fY2FyZERhdGEpO1xyXG4gICAgfSk7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxuXHJcbiAgb3Blbk1vZGFsKGNhcmREYXRhKSB7XHJcbiAgICAvL2FzIEkgdXNlIHRoZSBvcGVuTW9kYWwgaW4gaGFuZGxlRGVsZXRlQ2xpY2ssIEknbGwgcGFzcyBjYXJkJ3MgZGF0YSB0byBpdCBpbiBvcmRlciB0byBrbm93IGNhcmQncyBpZFxyXG4gICAgdGhpcy5fY2FyZERhdGEgPSBjYXJkRGF0YTtcclxuICAgIHN1cGVyLm9wZW5Nb2RhbCgpO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwiZGF0YSIsImNhcmRTZWxlY3RvciIsImhhbmRsZUltYWdlQ2xpY2siLCJoYW5kbGVEZWxldGVDbGljayIsImhhbmRsZUxpa2VDbGljayIsInRoaXMiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfaWQiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfaGFuZGxlRGVsZXRlQ2xpY2siLCJfaGFuZGxlTGlrZUNsaWNrIiwiX2lzTGlrZWQiLCJpc0xpa2VkIiwiX2dldFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImZpcnN0RWxlbWVudENoaWxkIiwiY2xvbmVOb2RlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2VsZW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiX2xpa2VCdXR0b24iLCJyZW1vdmVDYXJkIiwicmVtb3ZlIiwiZ2VuZXJhdGVDYXJkIiwiX3JlbmRlckxpa2VzIiwiY2FyZFRpdGxlIiwiY2FyZEltYWdlIiwic2V0QXR0cmlidXRlIiwidGV4dENvbnRlbnQiLCJnZXRJZCIsImdldExpa2VTdGF0dXMiLCJzZXRMaWtlU3RhdHVzIiwic3RhdHVzIiwiY2xhc3NMaXN0IiwiYWRkIiwiRm9ybVZhbGlkYXRvciIsIm9wdGlvbnMiLCJmb3JtRWxlbWVudCIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9zaG93RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJlcnJvck1lc3NhZ2UiLCJlcnJvckVsZW1lbnQiLCJpZCIsIl9oaWRlRXJyb3IiLCJfaGFzSW52YWxpZElucHV0IiwiaW5wdXRMaXN0Iiwic29tZSIsInZhbGlkaXR5IiwidmFsaWQiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsIl9pbnB1dExpc3QiLCJfYnV0dG9uRWxlbWVudCIsInJlbW92ZUF0dHJpYnV0ZSIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiZW5hYmxlVmFsaWRhdGlvbiIsImV2dCIsInByZXZlbnREZWZhdWx0IiwicmVzZXRWYWxpZGF0aW9uIiwiU2VjdGlvbiIsIl9yZWYiLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfcmVuZGVyZWRJdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsIml0ZW0iLCJhZGRJdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50Iiwib3Blbk1vZGFsIiwiX2hhbmRsZUVzYyIsImNsb3NlTW9kYWwiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJ0YXJnZXQiLCJjb250YWlucyIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9wb3B1cEZvcm0iLCJfc2F2ZUJ1dHRvbiIsIl9zYXZlQnV0dG9uVGV4dCIsIl9nZXRJbnB1dFZhbHVlcyIsIl9mb3JtVmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsInJlc2V0IiwicmVuZGVyTG9hZGluZyIsImlzTG9hZGluZyIsImxvYWRpbmdUZXh0IiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwicHJvZmlsZUVkaXRCdXR0b24iLCJwcm9maWxlRm9ybUVsZW1lbnQiLCJwcm9maWxlQWRkQnV0dG9uIiwicHJvZmlsZUF2YXRhcldyYXBwZXIiLCJlZGl0UHJvZmlsZVRpdGxlSW5wdXQiLCJlZGl0UHJvZmlsZURlc2NyaXB0aW9uSW5wdXQiLCJmb3JtU2VsZWN0b3IiLCJlZGl0UHJvZmlsZUZvcm0iLCJhZGRDYXJkRm9ybSIsImF2YXRhckZvcm0iLCJhcGkiLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJfY2hlY2tSZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJsb2FkVXNlckluZm8iLCJmZXRjaCIsInRoZW4iLCJnZXRJbml0aWFsQ2FyZHMiLCJlZGl0VXNlckluZm8iLCJhYm91dCIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWRkTmV3Q2FyZCIsImRlbGV0ZUNhcmQiLCJjYXJkSWQiLCJsaWtlQ2FyZCIsInVubGlrZUNhcmQiLCJ1cGRhdGVBdmF0YXIiLCJhdmF0YXIiLCJsb2FkUGFnZUNvbnRlbnQiLCJhbGwiLCJhdXRob3JpemF0aW9uIiwiZ2FsbGVyeUxpc3RTZWN0aW9uIiwidXNlckRhdGEiLCJjYXJkQXJyIiwidXNlckluZm8iLCJzZXRVc2VySW5mbyIsInNldEF2YXRhciIsInJldmVyc2UiLCJjYXJkRWxlbWVudCIsImNyZWF0ZUNhcmQiLCJjYXRjaCIsImNvbnNvbGUiLCJlcnJvciIsInByb2ZpbGVOYW1lU2VsZWN0b3IiLCJwcm9maWxlRGVzY3JpcHRpb25TZWxlY3RvciIsInByb2ZpbGVBdmF0YXJTZWxlY3RvciIsIl9wcm9maWxlTmFtZSIsIl9wcm9maWxlRGVzY3JpcHRpb24iLCJfcHJvZmlsZUF2YXRhciIsImdldFVzZXJJbmZvIiwiZGVzY3JpcHRpb24iLCJzcmMiLCJpbmZvIiwiZWRpdEZvcm1WYWxpZGF0b3IiLCJwcm9maWxlRm9ybVBvcHVwIiwiaW5wdXRWYWx1ZXMiLCJmaW5hbGx5IiwiYXZhdGFyRm9ybVBvcHVwIiwiaW5wdXRWYWx1ZSIsImF2YXRhckZvcm1WYWxpZGF0b3IiLCJwb3B1cFdpdGhJbWFnZSIsIl9wcmV2aWV3SW1hZ2UiLCJfcHJldmlld0Rlc2NyaXB0aW9uIiwibmV3Q2FyZEZvcm1Qb3B1cCIsImNhcmRGb3JtVmFsaWRhdG9yIiwiY2FyZERhdGEiLCJjb25maXJtUG9wdXAiLCJjYXJkIiwiaGFuZGxlQ29uZmlybVN1Ym1pdCIsIl9oYW5kbGVDb25maXJtU3VibWl0IiwiX2NvbmZpcm1CdXR0b24iLCJfY2FyZERhdGEiXSwic291cmNlUm9vdCI6IiJ9