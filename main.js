!function(){"use strict";class e{constructor(e,t,s,r,i){this._name=e.name,this._link=e.link,this._id=e._id,this._cardSelector=t,this._handleImageClick=s,this._handleDeleteClick=r,this._handleLikeClick=i,this._isLiked=e.isLiked}_getTemplate(){return document.querySelector(this._cardSelector).content.firstElementChild.cloneNode(!0)}_setEventListeners(){this._element.querySelector(".card__image").addEventListener("click",(()=>{this._handleImageClick(this._link,this._name)})),this._likeButton=this._element.querySelector(".card__like-button"),this._likeButton.addEventListener("click",(()=>{this._handleLikeClick(this)})),this._element.querySelector(".card__trash-button").addEventListener("click",(()=>{this._handleDeleteClick(this)}))}removeCard(){this._element.remove()}generateCard(){this._element=this._getTemplate(),this._setEventListeners(),this._renderLikes();const e=this._element.querySelector(".card__title"),t=this._element.querySelector(".card__image");return t.setAttribute("src",this._link),t.setAttribute("alt",this._name),e.textContent=this._name,this._element}getId(){return this._id}getLikeStatus(){return this._isLiked}setLikeStatus(e){this._isLiked=e,this._renderLikes()}_renderLikes(){this._isLiked?this._likeButton.classList.add("card__like-button_active"):this._likeButton.classList.remove("card__like-button_active")}}class t{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._element=t}_showError(e,t){const s=this._element.querySelector(`.${e.id}-error`);e.classList.add(this._inputErrorClass),s.textContent=t,s.classList.add(this._errorClass)}_hideError(e){const t=this._element.querySelector(`.${e.id}-error`);e.classList.remove(this._inputErrorClass),t.classList.remove(this._errorClass),t.textContent=""}_hasInvalidInput(e){return e.some((e=>!e.validity.valid))}toggleButtonState(){this._hasInvalidInput(this._inputList)?(this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.setAttribute("disabled","")):(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.removeAttribute("disabled",""))}_checkInputValidity(e){e.validity.valid?this._hideError(e):this._showError(e,e.validationMessage)}_setEventListeners(){this._inputList=Array.from(this._element.querySelectorAll(this._inputSelector)),this._buttonElement=this._element.querySelector(this._submitButtonSelector),this.toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._element.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}resetValidation(){this.toggleButtonState(),this._inputList.forEach((e=>{this._hideError(e)}))}}class s{constructor(e,t){let{items:s,renderer:r}=e;this._renderedItems=s,this._renderer=r,this._container=document.querySelector(t)}renderItems(){this._renderedItems.forEach((e=>{this._renderer(e)}))}addItem(e){this._container.prepend(e)}}class r{constructor(e){this._popupElement=document.querySelector(e)}openModal(){document.addEventListener("keydown",this._handleEsc),this._popupElement.classList.add("modal_opened")}closeModal(){document.removeEventListener("keydown",this._handleEsc),this._popupElement.classList.remove("modal_opened")}_handleEsc=e=>{"Escape"===e.key&&this.closeModal()};setEventListeners(){this._popupElement.addEventListener("click",(e=>{(e.target===this._popupElement||e.target.classList.contains("modal__close"))&&this.closeModal()}))}}class i extends r{constructor(e){let{popupSelector:t,handleFormSubmit:s}=e;super(t),this._handleFormSubmit=s,this._popupForm=this._popupElement.querySelector(".modal__form"),this._saveButton=this._popupElement.querySelector(".modal__save")}_getInputValues(){return this._inputList=this._popupElement.querySelectorAll(".modal__input"),this._formValues={},this._inputList.forEach((e=>{this._formValues[e.name]=e.value})),this._formValues}setEventListeners(){this._popupElement.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())})),super.setEventListeners()}closeModal(){this._popupForm.reset(),super.closeModal()}setButtonText(e){this._saveButton.textContent=e}}const n=document.querySelector(".profile__edit-button"),o=document.querySelector(".modal__form"),a=document.querySelector(".profile__add-button"),l=document.querySelector(".profile__avatar-wrapper"),c=o.querySelector("#name-input-js"),d=o.querySelector("#description-input-js"),h={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__save",inactiveButtonClass:"modal__save_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__input-error_active"},u=document.querySelector("#editProfile-modal-form"),_=document.querySelector("#addCard-modal-form"),m=document.querySelector("#avatar-modal-form"),p=new class{constructor(){this._baseUrl="https://around-api.en.tripleten-services.com/v1",this._headers={authorization:"5bd639c7-c1c3-496d-947f-3773995c6d1b","Content-Type":"application/json"}}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}loadUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then(this._checkResponse)}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then(this._checkResponse)}editUserInfo(e,t){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then(this._checkResponse)}addNewCard(e,t){return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}likeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._checkResponse)}unlikeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}updateAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then(this._checkResponse)}loadPageContent(){return Promise.all([this.loadUserInfo(),this.getInitialCards()])}}({});let v;p.loadPageContent().then((e=>{let[t,r]=e;S.setUserInfo(t.name,t.about),S.setAvatar(t.avatar),v=new s({items:r.reverse(),renderer:e=>{const t=C(e);v.addItem(t)}},".gallery__list"),v.renderItems()})).catch((e=>console.error(e)));const S=new class{constructor(e){let{profileNameSelector:t,profileDescriptionSelector:s,profileAvatarSelector:r}=e;this._profileName=document.querySelector(t),this._profileDescription=document.querySelector(s),this._profileAvatar=document.querySelector(r)}getUserInfo(){return{name:this._profileName.textContent,description:this._profileDescription.textContent}}setUserInfo(e,t){this._profileName.textContent=e,this._profileDescription.textContent=t}setAvatar(e){this._profileAvatar.src=e}}({profileNameSelector:".profile__title",profileDescriptionSelector:".profile__description",profileAvatarSelector:".profile__avatar"});n.addEventListener("click",(()=>{const e=S.getUserInfo();c.value=e.name,d.value=e.description,B.resetValidation(),f.openModal()}));const f=new i({popupSelector:"#edit-modal",handleFormSubmit:function(e){f.setButtonText("Saving..."),p.editUserInfo(e.name,e.description).then((e=>{S.setUserInfo(e.name,e.about),f.closeModal(),B.toggleButtonState()})).catch((e=>console.error(e))).finally((()=>{f.setButtonText("Save")}))}});f.setEventListeners();const E=new i({popupSelector:"#avatar-modal",handleFormSubmit:function(e){E.setButtonText("Saving..."),p.updateAvatar(e.link).then((e=>{S.setAvatar(e.avatar),E.closeModal(),w.toggleButtonState()})).catch((e=>console.error(e))).finally((()=>{E.setButtonText("Save")}))}});E.setEventListeners(),l.addEventListener("click",(()=>{w.resetValidation(),E.openModal()}));const k=new class extends r{constructor(e){let{popupSelector:t}=e;super(t),this._previewImage=document.querySelector(".modal__image"),this._previewDescription=document.querySelector(".modal__description")}openModal(e,t){this._previewImage.setAttribute("src",e),this._previewImage.setAttribute("alt",t),this._previewDescription.textContent=t,super.openModal()}}({popupSelector:"#previewModal"});function L(e,t){k.openModal(e,t)}k.setEventListeners();const b=new i({popupSelector:"#add-modal",handleFormSubmit:function(e){b.setButtonText("Saving..."),p.addNewCard(e.name,e.link).then((e=>{const t=C(e);v.addItem(t),b.closeModal(),q.toggleButtonState()})).catch((e=>console.error(e))).finally((()=>{b.setButtonText("Create")}))}});function g(e){I.openModal(e)}function C(t){return new e(t,"#card-template",L,g,y).generateCard()}function y(e){const t=e.getId();e.getLikeStatus()?p.unlikeCard(t).then((()=>{e.setLikeStatus(!1)})).catch((e=>console.error(`${e} Something went wrong`))):p.likeCard(t).then((()=>{e.setLikeStatus(!0)})).catch((e=>console.error(`${e} Something went wrong`)))}a.addEventListener("click",(()=>{q.resetValidation(),b.openModal()})),b.setEventListeners();const I=new class extends r{constructor(e){let{popupSelector:t,handleSubmit:s}=e;super(t),this._handleSubmit=s,this._confirmButton=document.querySelector(".modal__save_confirm")}setEventListeners(){this._confirmButton.addEventListener("click",(()=>{this._handleSubmit(this._cardData)})),super.setEventListeners()}openModal(e){this._cardData=e,super.openModal()}}({popupSelector:"#confirmationModal",handleSubmit:function(e){const t=e.getId();p.deleteCard(t).then((()=>{e.removeCard()})).catch((e=>console.error(e))),I.closeModal()}});I.setEventListeners();const B=new t(h,u),q=new t(h,_),w=new t(h,m);B.enableValidation(),q.enableValidation(),w.enableValidation(),p.getInitialCards().then((e=>{console.log(e)}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Oi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQ29uZmlybVBvcHVwLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgZGF0YSxcclxuICAgIGNhcmRTZWxlY3RvcixcclxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXHJcbiAgICBoYW5kbGVEZWxldGVDbGljayxcclxuICAgIGhhbmRsZUxpa2VDbGlja1xyXG4gICkge1xyXG4gICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcclxuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XHJcbiAgICB0aGlzLl9pZCA9IGRhdGEuX2lkO1xyXG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xyXG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayA9IGhhbmRsZURlbGV0ZUNsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrID0gaGFuZGxlTGlrZUNsaWNrO1xyXG4gICAgdGhpcy5faXNMaWtlZCA9IGRhdGEuaXNMaWtlZDtcclxuICB9XHJcblxyXG4gIF9nZXRUZW1wbGF0ZSgpIHtcclxuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxyXG4gICAgICAuY29udGVudC5maXJzdEVsZW1lbnRDaGlsZC5jbG9uZU5vZGUodHJ1ZSk7XHJcblxyXG4gICAgcmV0dXJuIGNhcmRFbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgY29uc3QgY2FyZEltYWdlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG4gICAgY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sodGhpcy5fbGluaywgdGhpcy5fbmFtZSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sodGhpcyk7XHJcbiAgICAgIC8vdGhpcy5faGFuZGxlQ2FyZExpa2UoKTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vbXkgdHJhc2ggYnV0dG9uXHJcbiAgICBjb25zdCB0cmFzaEJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190cmFzaC1idXR0b25cIik7XHJcbiAgICB0cmFzaEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayh0aGlzKTtcclxuICAgICAgLy90aGlzLl9oYW5kbGVEZWxldGVDYXJkKCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIHJlbW92ZUNhcmQoKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xyXG4gIH1cclxuXHJcbiAgLypoYW5kbGVDYXJkTGlrZSgpIHtcclxuICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcclxuICB9Ki9cclxuXHJcbiAgZ2VuZXJhdGVDYXJkKCkge1xyXG4gICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcclxuXHJcbiAgICBjb25zdCBjYXJkVGl0bGUgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XHJcbiAgICBjb25zdCBjYXJkSW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XHJcblxyXG4gICAgY2FyZEltYWdlLnNldEF0dHJpYnV0ZShcInNyY1wiLCB0aGlzLl9saW5rKTtcclxuICAgIGNhcmRJbWFnZS5zZXRBdHRyaWJ1dGUoXCJhbHRcIiwgdGhpcy5fbmFtZSk7XHJcbiAgICBjYXJkVGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG5cclxuICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgZ2V0SWQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faWQ7XHJcbiAgfVxyXG5cclxuICBnZXRMaWtlU3RhdHVzKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2lzTGlrZWQ7XHJcbiAgfVxyXG5cclxuICBzZXRMaWtlU3RhdHVzKHN0YXR1cykge1xyXG4gICAgdGhpcy5faXNMaWtlZCA9IHN0YXR1cztcclxuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7IC8vbm90IHN1cmUgYWJvdXQgdXNpbmcgdGhpcyBvbmUgaGVyZVxyXG4gIH1cclxuXHJcbiAgX3JlbmRlckxpa2VzKCkge1xyXG4gICAgaWYgKHRoaXMuX2lzTGlrZWQpIHtcclxuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3RvcihvcHRpb25zLCBmb3JtRWxlbWVudCkge1xyXG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IG9wdGlvbnMuaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gb3B0aW9ucy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcclxuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBvcHRpb25zLmluYWN0aXZlQnV0dG9uQ2xhc3M7XHJcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBvcHRpb25zLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBvcHRpb25zLmVycm9yQ2xhc3M7XHJcblxyXG4gICAgdGhpcy5fZWxlbWVudCA9IGZvcm1FbGVtZW50O1xyXG4gIH1cclxuXHJcbiAgX3Nob3dFcnJvcihpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSkge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfaGlkZUVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gIH1cclxuXHJcbiAgX2hhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpIHtcclxuICAgIHJldHVybiBpbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIHJldHVybiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICB0b2dnbGVCdXR0b25TdGF0ZSgpIHtcclxuICAgIGlmICh0aGlzLl9oYXNJbnZhbGlkSW5wdXQodGhpcy5faW5wdXRMaXN0KSkge1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgXCJcIik7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgXCJcIik7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xyXG4gICAgaWYgKGlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xyXG4gICAgICB0aGlzLl9oaWRlRXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX3Nob3dFcnJvcihpbnB1dEVsZW1lbnQsIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKFxyXG4gICAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcilcclxuICAgICk7XHJcbiAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvclxyXG4gICAgKTtcclxuICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuXHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcblxyXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuXHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIHRoaXMuX2hpZGVFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9yZW5kZXJlZEl0ZW1zID0gaXRlbXM7XHJcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICByZW5kZXJJdGVtcygpIHtcclxuICAgIHRoaXMuX3JlbmRlcmVkSXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xyXG4gICAgICB0aGlzLl9yZW5kZXJlcihpdGVtKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBvcGVuTW9kYWwoKSB7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2MpO1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgfVxyXG5cclxuICBjbG9zZU1vZGFsKCkge1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjKTtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUVzYyA9IChldnQpID0+IHtcclxuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgIHRoaXMuY2xvc2VNb2RhbCgpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGlmIChcclxuICAgICAgICBldnQudGFyZ2V0ID09PSB0aGlzLl9wb3B1cEVsZW1lbnQgfHxcclxuICAgICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX19jbG9zZVwiKVxyXG4gICAgICApIHtcclxuICAgICAgICB0aGlzLmNsb3NlTW9kYWwoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQgfSkge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG4gICAgdGhpcy5fc2F2ZUJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zYXZlXCIpO1xyXG4gIH1cclxuXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpO1xyXG4gICAgdGhpcy5fZm9ybVZhbHVlcyA9IHt9O1xyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgIHRoaXMuX2Zvcm1WYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIHRoaXMuX2Zvcm1WYWx1ZXM7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7IC8vdGhpcyBpcyB3aGVyZSBpbnB1dFZhbHVlcyBwYXJhbSBjb21lcyBmcm9tLiBUaGF0J3Mgd2h5IHdlIGNvbnNlcXVlbnRseSBwYXNzIGl0IGluIGluZGV4LmpzIGluc2lkZSBoYW5kbGVGb3JtU3VibWl0KCpoZXJlKik7XHJcbiAgICB9KTtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG5cclxuICBjbG9zZU1vZGFsKCkge1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLnJlc2V0KCk7XHJcbiAgICBzdXBlci5jbG9zZU1vZGFsKCk7XHJcbiAgfVxyXG5cclxuICBzZXRCdXR0b25UZXh0KHRleHQpIHtcclxuICAgIHRoaXMuX3NhdmVCdXR0b24udGV4dENvbnRlbnQgPSB0ZXh0O1xyXG4gIH1cclxufVxyXG4iLCIvL0VMRU1FTlRTIC0tLS0tXHJcbmNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcclxuY29uc3QgcHJvZmlsZUZvcm1FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuY29uc3QgcHJvZmlsZUFkZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcclxuY29uc3QgcHJvZmlsZUF2YXRhcldyYXBwZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhci13cmFwcGVyXCIpO1xyXG5cclxuLy9JTlBVVFMgLS0tLS1cclxuY29uc3QgZWRpdFByb2ZpbGVUaXRsZUlucHV0ID1cclxuICBwcm9maWxlRm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcIiNuYW1lLWlucHV0LWpzXCIpO1xyXG5jb25zdCBlZGl0UHJvZmlsZURlc2NyaXB0aW9uSW5wdXQgPSBwcm9maWxlRm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIiNkZXNjcmlwdGlvbi1pbnB1dC1qc1wiXHJcbik7XHJcblxyXG4vL0ZPUk0gVkFMSURBVE9SIE9QVElPTlMgLS0tLS1cclxuY29uc3Qgb3B0aW9ucyA9IHtcclxuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXHJcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19zYXZlXCIsXHJcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fc2F2ZV9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0LWVycm9yX2FjdGl2ZVwiLFxyXG59O1xyXG5cclxuLy9GT1JNUyAtLS0tLVxyXG5jb25zdCBlZGl0UHJvZmlsZUZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXRQcm9maWxlLW1vZGFsLWZvcm1cIik7XHJcbmNvbnN0IGFkZENhcmRGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGRDYXJkLW1vZGFsLWZvcm1cIik7XHJcbmNvbnN0IGF2YXRhckZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2F2YXRhci1tb2RhbC1mb3JtXCIpO1xyXG5cclxuZXhwb3J0IHtcclxuICBwcm9maWxlRWRpdEJ1dHRvbixcclxuICBwcm9maWxlQWRkQnV0dG9uLFxyXG4gIHByb2ZpbGVBdmF0YXJXcmFwcGVyLFxyXG4gIGVkaXRQcm9maWxlVGl0bGVJbnB1dCxcclxuICBlZGl0UHJvZmlsZURlc2NyaXB0aW9uSW5wdXQsXHJcbiAgb3B0aW9ucyxcclxuICBlZGl0UHJvZmlsZUZvcm0sXHJcbiAgYWRkQ2FyZEZvcm0sXHJcbiAgYXZhdGFyRm9ybSxcclxufTtcclxuIiwiLy8gQ0xBU1NFUyBJTVBPUlRTICsgU1RZTEVTSEVFVCAtLS0tLVxyXG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcclxuXHJcbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcblxyXG4vLyBDT05TVEFOVFMgSU1QT1JUUyAtLS0tLVxyXG5pbXBvcnQge1xyXG4gIHByb2ZpbGVFZGl0QnV0dG9uLFxyXG4gIHByb2ZpbGVBZGRCdXR0b24sXHJcbiAgcHJvZmlsZUF2YXRhcldyYXBwZXIsXHJcbiAgZWRpdFByb2ZpbGVUaXRsZUlucHV0LFxyXG4gIGVkaXRQcm9maWxlRGVzY3JpcHRpb25JbnB1dCxcclxuICBvcHRpb25zLFxyXG4gIGVkaXRQcm9maWxlRm9ybSxcclxuICBhZGRDYXJkRm9ybSxcclxuICBhdmF0YXJGb3JtLFxyXG59IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcclxuaW1wb3J0IENvbmZpcm1Qb3B1cCBmcm9tIFwiLi4vY29tcG9uZW50cy9Db25maXJtUG9wdXAuanNcIjtcclxuXHJcbi8vUEFHRSBMT0FEIC0tLS0tXHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHt9KTtcclxuXHJcbmxldCBnYWxsZXJ5TGlzdFNlY3Rpb247XHJcbmFwaVxyXG4gIC5sb2FkUGFnZUNvbnRlbnQoKVxyXG4gIC50aGVuKChbdXNlckRhdGEsIGNhcmRBcnJdKSA9PiB7XHJcbiAgICB1c2VySW5mby5zZXRVc2VySW5mbyh1c2VyRGF0YS5uYW1lLCB1c2VyRGF0YS5hYm91dCk7XHJcbiAgICB1c2VySW5mby5zZXRBdmF0YXIodXNlckRhdGEuYXZhdGFyKTtcclxuXHJcbiAgICBnYWxsZXJ5TGlzdFNlY3Rpb24gPSBuZXcgU2VjdGlvbihcclxuICAgICAge1xyXG4gICAgICAgIGl0ZW1zOiBjYXJkQXJyLnJldmVyc2UoKSxcclxuICAgICAgICByZW5kZXJlcjogKGRhdGEpID0+IHtcclxuICAgICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gY3JlYXRlQ2FyZChkYXRhKTtcclxuICAgICAgICAgIGdhbGxlcnlMaXN0U2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTtcclxuICAgICAgICB9LFxyXG4gICAgICB9LFxyXG4gICAgICBcIi5nYWxsZXJ5X19saXN0XCJcclxuICAgICk7XHJcbiAgICBnYWxsZXJ5TGlzdFNlY3Rpb24ucmVuZGVySXRlbXMoKTtcclxuICB9KVxyXG4gIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKGVycikpO1xyXG5cclxuLy8gVVNFUiBJTkZPIC0tLS0tXHJcblxyXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XHJcbiAgcHJvZmlsZU5hbWVTZWxlY3RvcjogXCIucHJvZmlsZV9fdGl0bGVcIixcclxuICBwcm9maWxlRGVzY3JpcHRpb25TZWxlY3RvcjogXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIixcclxuICBwcm9maWxlQXZhdGFyU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2F2YXRhclwiLFxyXG59KTtcclxuXHJcbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgY29uc3QgaW5mbyA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgZWRpdFByb2ZpbGVUaXRsZUlucHV0LnZhbHVlID0gaW5mby5uYW1lO1xyXG4gIGVkaXRQcm9maWxlRGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IGluZm8uZGVzY3JpcHRpb247XHJcbiAgZWRpdEZvcm1WYWxpZGF0b3IucmVzZXRWYWxpZGF0aW9uKCk7IC8vSSdtIGhlcmVcclxuICBwcm9maWxlRm9ybVBvcHVwLm9wZW5Nb2RhbCgpO1xyXG59KTtcclxuXHJcbi8vIFBST0ZJTEUgRk9STSBQT1BVUCAtLS0tLVxyXG5cclxuY29uc3QgcHJvZmlsZUZvcm1Qb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcclxuICBwb3B1cFNlbGVjdG9yOiBcIiNlZGl0LW1vZGFsXCIsXHJcbiAgaGFuZGxlRm9ybVN1Ym1pdDogaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQsXHJcbn0pO1xyXG5cclxucHJvZmlsZUZvcm1Qb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQoaW5wdXRWYWx1ZXMpIHtcclxuICBwcm9maWxlRm9ybVBvcHVwLnNldEJ1dHRvblRleHQoXCJTYXZpbmcuLi5cIik7XHJcbiAgYXBpXHJcbiAgICAuZWRpdFVzZXJJbmZvKGlucHV0VmFsdWVzLm5hbWUsIGlucHV0VmFsdWVzLmRlc2NyaXB0aW9uKVxyXG4gICAgLnRoZW4oKHVzZXJEYXRhKSA9PiB7XHJcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHVzZXJEYXRhLm5hbWUsIHVzZXJEYXRhLmFib3V0KTtcclxuICAgICAgcHJvZmlsZUZvcm1Qb3B1cC5jbG9zZU1vZGFsKCk7XHJcbiAgICAgIGVkaXRGb3JtVmFsaWRhdG9yLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoZXJyKSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgcHJvZmlsZUZvcm1Qb3B1cC5zZXRCdXR0b25UZXh0KFwiU2F2ZVwiKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG4vL0FWQVRBUiBGT1JNIFBPUFVQIC0tLS0tXHJcblxyXG5jb25zdCBhdmF0YXJGb3JtUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XHJcbiAgcG9wdXBTZWxlY3RvcjogXCIjYXZhdGFyLW1vZGFsXCIsXHJcbiAgaGFuZGxlRm9ybVN1Ym1pdDogaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdCxcclxufSk7XHJcblxyXG5hdmF0YXJGb3JtUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbnByb2ZpbGVBdmF0YXJXcmFwcGVyLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgYXZhdGFyRm9ybVZhbGlkYXRvci5yZXNldFZhbGlkYXRpb24oKTtcclxuICBhdmF0YXJGb3JtUG9wdXAub3Blbk1vZGFsKCk7XHJcbn0pO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdChpbnB1dFZhbHVlKSB7XHJcbiAgYXZhdGFyRm9ybVBvcHVwLnNldEJ1dHRvblRleHQoXCJTYXZpbmcuLi5cIik7XHJcbiAgYXBpXHJcbiAgICAudXBkYXRlQXZhdGFyKGlucHV0VmFsdWUubGluaylcclxuICAgIC50aGVuKCh1c2VyRGF0YSkgPT4ge1xyXG4gICAgICB1c2VySW5mby5zZXRBdmF0YXIodXNlckRhdGEuYXZhdGFyKTtcclxuICAgICAgYXZhdGFyRm9ybVBvcHVwLmNsb3NlTW9kYWwoKTtcclxuICAgICAgYXZhdGFyRm9ybVZhbGlkYXRvci50b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKGVycikpXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIGF2YXRhckZvcm1Qb3B1cC5zZXRCdXR0b25UZXh0KFwiU2F2ZVwiKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG4vLyBQT1BVUCBXSVRIIElNQUdFIC0tLS0tXHJcblxyXG5jb25zdCBwb3B1cFdpdGhJbWFnZSA9IG5ldyBQb3B1cFdpdGhJbWFnZSh7XHJcbiAgcG9wdXBTZWxlY3RvcjogXCIjcHJldmlld01vZGFsXCIsXHJcbn0pO1xyXG5cclxucG9wdXBXaXRoSW1hZ2Uuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUltYWdlQ2xpY2sobGluaywgbmFtZSkge1xyXG4gIHBvcHVwV2l0aEltYWdlLm9wZW5Nb2RhbChsaW5rLCBuYW1lKTtcclxufVxyXG5cclxuLy8gQUREIE5FVyBDQVJEIEZPUk0gLS0tLS1cclxuXHJcbmNvbnN0IG5ld0NhcmRGb3JtUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XHJcbiAgcG9wdXBTZWxlY3RvcjogXCIjYWRkLW1vZGFsXCIsXHJcbiAgaGFuZGxlRm9ybVN1Ym1pdDogaGFuZGxlQWRkQ2FyZEZvcm1TdWJtaXQsXHJcbn0pO1xyXG5cclxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlQ2xpY2soY2FyZERhdGEpIHtcclxuICBjb25maXJtUG9wdXAub3Blbk1vZGFsKGNhcmREYXRhKTtcclxufVxyXG5cclxucHJvZmlsZUFkZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGNhcmRGb3JtVmFsaWRhdG9yLnJlc2V0VmFsaWRhdGlvbigpO1xyXG4gIG5ld0NhcmRGb3JtUG9wdXAub3Blbk1vZGFsKCk7XHJcbn0pO1xyXG5cclxuZnVuY3Rpb24gY3JlYXRlQ2FyZChkYXRhKSB7XHJcbiAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxyXG4gICAgZGF0YSxcclxuICAgIFwiI2NhcmQtdGVtcGxhdGVcIixcclxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXHJcbiAgICBoYW5kbGVEZWxldGVDbGljayxcclxuICAgIGhhbmRsZUxpa2VDbGlja1xyXG4gICk7XHJcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkLmdlbmVyYXRlQ2FyZCgpO1xyXG4gIHJldHVybiBjYXJkRWxlbWVudDtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlTGlrZUNsaWNrKGNhcmQpIHtcclxuICBjb25zdCBjYXJkSWQgPSBjYXJkLmdldElkKCk7XHJcbiAgaWYgKGNhcmQuZ2V0TGlrZVN0YXR1cygpKSB7XHJcbiAgICBhcGlcclxuICAgICAgLnVubGlrZUNhcmQoY2FyZElkKVxyXG4gICAgICAudGhlbigoKSA9PiB7XHJcbiAgICAgICAgY2FyZC5zZXRMaWtlU3RhdHVzKGZhbHNlKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoYCR7ZXJyfSBTb21ldGhpbmcgd2VudCB3cm9uZ2ApKTtcclxuICB9IGVsc2Uge1xyXG4gICAgYXBpXHJcbiAgICAgIC5saWtlQ2FyZChjYXJkSWQpXHJcbiAgICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgICBjYXJkLnNldExpa2VTdGF0dXModHJ1ZSk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmVycm9yKGAke2Vycn0gU29tZXRoaW5nIHdlbnQgd3JvbmdgKSk7XHJcbiAgfVxyXG59XHJcblxyXG5uZXdDYXJkRm9ybVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVBZGRDYXJkRm9ybVN1Ym1pdChpbnB1dFZhbHVlcykge1xyXG4gIG5ld0NhcmRGb3JtUG9wdXAuc2V0QnV0dG9uVGV4dChcIlNhdmluZy4uLlwiKTtcclxuICBhcGlcclxuICAgIC5hZGROZXdDYXJkKGlucHV0VmFsdWVzLm5hbWUsIGlucHV0VmFsdWVzLmxpbmspXHJcbiAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoZGF0YSk7XHJcbiAgICAgIGdhbGxlcnlMaXN0U2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTtcclxuICAgICAgbmV3Q2FyZEZvcm1Qb3B1cC5jbG9zZU1vZGFsKCk7XHJcbiAgICAgIGNhcmRGb3JtVmFsaWRhdG9yLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoZXJyKSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgbmV3Q2FyZEZvcm1Qb3B1cC5zZXRCdXR0b25UZXh0KFwiQ3JlYXRlXCIpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8vQ09ORklSTUFUSU9OIFBPUFVQIC0tLS0tXHJcblxyXG5mdW5jdGlvbiBoYW5kbGVTdWJtaXQoY2FyZCkge1xyXG4gIGNvbnN0IGNhcmRJZCA9IGNhcmQuZ2V0SWQoKTtcclxuICBhcGlcclxuICAgIC5kZWxldGVDYXJkKGNhcmRJZClcclxuICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgY2FyZC5yZW1vdmVDYXJkKCk7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUuZXJyb3IoZXJyKSk7XHJcbiAgY29uZmlybVBvcHVwLmNsb3NlTW9kYWwoKTtcclxufVxyXG5cclxuY29uc3QgY29uZmlybVBvcHVwID0gbmV3IENvbmZpcm1Qb3B1cCh7XHJcbiAgcG9wdXBTZWxlY3RvcjogXCIjY29uZmlybWF0aW9uTW9kYWxcIixcclxuICBoYW5kbGVTdWJtaXQsXHJcbn0pO1xyXG5cclxuY29uZmlybVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4vL0ZPUk0gSU5JVCAtLS0tLVxyXG5cclxuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihvcHRpb25zLCBlZGl0UHJvZmlsZUZvcm0pO1xyXG5jb25zdCBjYXJkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKG9wdGlvbnMsIGFkZENhcmRGb3JtKTtcclxuY29uc3QgYXZhdGFyRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKG9wdGlvbnMsIGF2YXRhckZvcm0pO1xyXG5cclxuZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5jYXJkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbmF2YXRhckZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuLy9UUllJTkcgQVBJIC0tLS0tXHJcblxyXG4vKmFwaS5sb2FkVXNlckluZm8oKS50aGVuKCh1c2VyRGF0YSkgPT4ge1xyXG4gIHVzZXJJbmZvLnNldFVzZXJJbmZvKHVzZXJEYXRhLm5hbWUsIHVzZXJEYXRhLmFib3V0KTtcclxufSk7Ki9cclxuXHJcbmFwaS5nZXRJbml0aWFsQ2FyZHMoKS50aGVuKChjYXJkQXJyKSA9PiB7XHJcbiAgY29uc29sZS5sb2coY2FyZEFycik7XHJcbn0pO1xyXG4iLCIvL2NvbnN0IGNvbmZpZyA9IHt9OyAvL2kgZG9uJ3QgcmVhbGx5IHNlZSB0aGF0IGFzIGEgbmVjZXNzaXR5IGF0IHRoaXMgcG9pbnRcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICB0aGlzLl9iYXNlVXJsID0gXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiO1xyXG4gICAgdGhpcy5faGVhZGVycyA9IHtcclxuICAgICAgYXV0aG9yaXphdGlvbjogXCI1YmQ2MzljNy1jMWMzLTQ5NmQtOTQ3Zi0zNzczOTk1YzZkMWJcIixcclxuICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrUmVzcG9uc2UocmVzKSB7XHJcbiAgICAvL2dldHMgY2FsbGVkIGluIGVhY2ggbWV0aG9kIGluIC50aGVuXHJcbiAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gIH1cclxuXHJcbiAgbG9hZFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICBlZGl0VXNlckluZm8obmFtZSwgYWJvdXQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBuYW1lLFxyXG4gICAgICAgIGFib3V0OiBhYm91dCxcclxuICAgICAgfSksXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgYWRkTmV3Q2FyZChuYW1lLCBsaW5rKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBuYW1lLFxyXG4gICAgICAgIGxpbms6IGxpbmssXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgbGlrZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gIH1cclxuXHJcbiAgdW5saWtlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVBdmF0YXIobGluaykge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBhdmF0YXI6IGxpbmssXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcblxyXG4gIGxvYWRQYWdlQ29udGVudCgpIHtcclxuICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5sb2FkVXNlckluZm8oKSwgdGhpcy5nZXRJbml0aWFsQ2FyZHMoKV0pO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgY29uc3RydWN0b3Ioe1xyXG4gICAgcHJvZmlsZU5hbWVTZWxlY3RvcixcclxuICAgIHByb2ZpbGVEZXNjcmlwdGlvblNlbGVjdG9yLFxyXG4gICAgcHJvZmlsZUF2YXRhclNlbGVjdG9yLFxyXG4gIH0pIHtcclxuICAgIHRoaXMuX3Byb2ZpbGVOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwcm9maWxlTmFtZVNlbGVjdG9yKTtcclxuICAgIHRoaXMuX3Byb2ZpbGVEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIHByb2ZpbGVEZXNjcmlwdGlvblNlbGVjdG9yXHJcbiAgICApO1xyXG4gICAgdGhpcy5fcHJvZmlsZUF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocHJvZmlsZUF2YXRhclNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbmFtZTogdGhpcy5fcHJvZmlsZU5hbWUudGV4dENvbnRlbnQsXHJcbiAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLl9wcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQsXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8obmFtZSwgZGVzY3JpcHRpb24pIHtcclxuICAgIHRoaXMuX3Byb2ZpbGVOYW1lLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHRoaXMuX3Byb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IGRlc2NyaXB0aW9uO1xyXG4gIH1cclxuXHJcbiAgc2V0QXZhdGFyKGF2YXRhcikge1xyXG4gICAgdGhpcy5fcHJvZmlsZUF2YXRhci5zcmMgPSBhdmF0YXI7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcclxuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fcHJldmlld0ltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9wcmV2aWV3RGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19kZXNjcmlwdGlvblwiKTtcclxuICB9XHJcblxyXG4gIG9wZW5Nb2RhbChsaW5rLCBuYW1lKSB7XHJcbiAgICB0aGlzLl9wcmV2aWV3SW1hZ2Uuc2V0QXR0cmlidXRlKFwic3JjXCIsIGxpbmspO1xyXG4gICAgdGhpcy5fcHJldmlld0ltYWdlLnNldEF0dHJpYnV0ZShcImFsdFwiLCBuYW1lKTtcclxuICAgIHRoaXMuX3ByZXZpZXdEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICBzdXBlci5vcGVuTW9kYWwoKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDb25maXJtUG9wdXAgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yLCBoYW5kbGVTdWJtaXQgfSkge1xyXG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9oYW5kbGVTdWJtaXQgPSBoYW5kbGVTdWJtaXQ7IC8vaGFuZGxlU3VibWl0ID0gdGhlIGZ1bmMgdGhhdCBleGVjdXRlcyBhcGkgXCJERUxFVEVcIiBsb2dpYywgaXQncyBsaWtlIGEgcmVuZGVyZXJcclxuICAgIHRoaXMuX2NvbmZpcm1CdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zYXZlX2NvbmZpcm1cIik7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2NvbmZpcm1CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlU3VibWl0KHRoaXMuX2NhcmREYXRhKTtcclxuICAgIH0pO1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcblxyXG4gIG9wZW5Nb2RhbChjYXJkRGF0YSkge1xyXG4gICAgLy9hcyBJIHVzZSB0aGUgb3Blbk1vZGFsIGluIGhhbmRsZURlbGV0ZUNsaWNrLCBJJ2xsIHBhc3MgY2FyZCdzIGRhdGEgdG8gaXQgaW4gb3JkZXIgdG8ga25vdyBjYXJkJ3MgaWRcclxuICAgIHRoaXMuX2NhcmREYXRhID0gY2FyZERhdGE7XHJcbiAgICBzdXBlci5vcGVuTW9kYWwoKTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsImRhdGEiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwiaGFuZGxlRGVsZXRlQ2xpY2siLCJoYW5kbGVMaWtlQ2xpY2siLCJ0aGlzIiwiX25hbWUiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2lkIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZURlbGV0ZUNsaWNrIiwiX2hhbmRsZUxpa2VDbGljayIsIl9pc0xpa2VkIiwiaXNMaWtlZCIsIl9nZXRUZW1wbGF0ZSIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnQiLCJmaXJzdEVsZW1lbnRDaGlsZCIsImNsb25lTm9kZSIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9lbGVtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9saWtlQnV0dG9uIiwicmVtb3ZlQ2FyZCIsInJlbW92ZSIsImdlbmVyYXRlQ2FyZCIsIl9yZW5kZXJMaWtlcyIsImNhcmRUaXRsZSIsImNhcmRJbWFnZSIsInNldEF0dHJpYnV0ZSIsInRleHRDb250ZW50IiwiZ2V0SWQiLCJnZXRMaWtlU3RhdHVzIiwic2V0TGlrZVN0YXR1cyIsInN0YXR1cyIsImNsYXNzTGlzdCIsImFkZCIsIkZvcm1WYWxpZGF0b3IiLCJvcHRpb25zIiwiZm9ybUVsZW1lbnQiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfc2hvd0Vycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlIiwiZXJyb3JFbGVtZW50IiwiaWQiLCJfaGlkZUVycm9yIiwiX2hhc0ludmFsaWRJbnB1dCIsImlucHV0TGlzdCIsInNvbWUiLCJ2YWxpZGl0eSIsInZhbGlkIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJfaW5wdXRMaXN0IiwiX2J1dHRvbkVsZW1lbnQiLCJyZW1vdmVBdHRyaWJ1dGUiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsImVuYWJsZVZhbGlkYXRpb24iLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsInJlc2V0VmFsaWRhdGlvbiIsIlNlY3Rpb24iLCJfcmVmIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX3JlbmRlcmVkSXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJpdGVtIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIm9wZW5Nb2RhbCIsIl9oYW5kbGVFc2MiLCJjbG9zZU1vZGFsIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfcG9wdXBGb3JtIiwiX3NhdmVCdXR0b24iLCJfZ2V0SW5wdXRWYWx1ZXMiLCJfZm9ybVZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJyZXNldCIsInNldEJ1dHRvblRleHQiLCJ0ZXh0IiwicHJvZmlsZUVkaXRCdXR0b24iLCJwcm9maWxlRm9ybUVsZW1lbnQiLCJwcm9maWxlQWRkQnV0dG9uIiwicHJvZmlsZUF2YXRhcldyYXBwZXIiLCJlZGl0UHJvZmlsZVRpdGxlSW5wdXQiLCJlZGl0UHJvZmlsZURlc2NyaXB0aW9uSW5wdXQiLCJmb3JtU2VsZWN0b3IiLCJlZGl0UHJvZmlsZUZvcm0iLCJhZGRDYXJkRm9ybSIsImF2YXRhckZvcm0iLCJhcGkiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiYXV0aG9yaXphdGlvbiIsIl9jaGVja1Jlc3BvbnNlIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsImxvYWRVc2VySW5mbyIsImZldGNoIiwiaGVhZGVycyIsInRoZW4iLCJnZXRJbml0aWFsQ2FyZHMiLCJlZGl0VXNlckluZm8iLCJhYm91dCIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWRkTmV3Q2FyZCIsImRlbGV0ZUNhcmQiLCJjYXJkSWQiLCJsaWtlQ2FyZCIsInVubGlrZUNhcmQiLCJ1cGRhdGVBdmF0YXIiLCJhdmF0YXIiLCJsb2FkUGFnZUNvbnRlbnQiLCJhbGwiLCJnYWxsZXJ5TGlzdFNlY3Rpb24iLCJ1c2VyRGF0YSIsImNhcmRBcnIiLCJ1c2VySW5mbyIsInNldFVzZXJJbmZvIiwic2V0QXZhdGFyIiwicmV2ZXJzZSIsImNhcmRFbGVtZW50IiwiY3JlYXRlQ2FyZCIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImVycm9yIiwicHJvZmlsZU5hbWVTZWxlY3RvciIsInByb2ZpbGVEZXNjcmlwdGlvblNlbGVjdG9yIiwicHJvZmlsZUF2YXRhclNlbGVjdG9yIiwiX3Byb2ZpbGVOYW1lIiwiX3Byb2ZpbGVEZXNjcmlwdGlvbiIsIl9wcm9maWxlQXZhdGFyIiwiZ2V0VXNlckluZm8iLCJkZXNjcmlwdGlvbiIsInNyYyIsImluZm8iLCJlZGl0Rm9ybVZhbGlkYXRvciIsInByb2ZpbGVGb3JtUG9wdXAiLCJpbnB1dFZhbHVlcyIsImZpbmFsbHkiLCJhdmF0YXJGb3JtUG9wdXAiLCJpbnB1dFZhbHVlIiwiYXZhdGFyRm9ybVZhbGlkYXRvciIsInBvcHVwV2l0aEltYWdlIiwiX3ByZXZpZXdJbWFnZSIsIl9wcmV2aWV3RGVzY3JpcHRpb24iLCJuZXdDYXJkRm9ybVBvcHVwIiwiY2FyZEZvcm1WYWxpZGF0b3IiLCJjYXJkRGF0YSIsImNvbmZpcm1Qb3B1cCIsImNhcmQiLCJoYW5kbGVTdWJtaXQiLCJfaGFuZGxlU3VibWl0IiwiX2NvbmZpcm1CdXR0b24iLCJfY2FyZERhdGEiLCJsb2ciXSwic291cmNlUm9vdCI6IiJ9